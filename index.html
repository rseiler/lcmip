<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.6 at 2015-03-18 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>LCMiP &#x2013; LMCiP - Log Called Methods in Production</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20150318" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                LCMiP
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2015-03-18</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0</span>
                      </div>
            <div class="xright">        
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
            <strong>Introduction</strong>
          </li>
                  <li class="none">
                          <a href="downloads.html" title="Downloads">Downloads</a>
            </li>
          </ul>
                       <h5>Modules</h5>
                  <ul>
                  <li class="none">
                          <a href="lcmip-javaagent/index.html" title="lcmip-javaagent">lcmip-javaagent</a>
            </li>
                  <li class="none">
                          <a href="lcmip-jar-analyser/index.html" title="lcmip-jar-analyser">lcmip-jar-analyser</a>
            </li>
                  <li class="none">
                          <a href="lcmip-summary/index.html" title="lcmip-summary">lcmip-summary</a>
            </li>
                  <li class="none">
                          <a href="lcmip-demo/index.html" title="lcmip-demo">lcmip-demo</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                <li class="expanded">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                    <ul>
                      <li class="none">
            <strong>About</strong>
          </li>
                      <li class="none">
                          <a href="dependencies.html" title="Dependencies">Dependencies</a>
            </li>
                      <li class="none">
                          <a href="dependency-info.html" title="Dependency Information">Dependency Information</a>
            </li>
                      <li class="none">
                          <a href="dependency-management.html" title="Dependency Management">Dependency Management</a>
            </li>
                      <li class="none">
                          <a href="license.html" title="Project License">Project License</a>
            </li>
                      <li class="none">
                          <a href="modules.html" title="Project Modules">Project Modules</a>
            </li>
                      <li class="none">
                          <a href="plugin-management.html" title="Plugin Management">Plugin Management</a>
            </li>
                      <li class="none">
                          <a href="team-list.html" title="Project Team">Project Team</a>
            </li>
                      <li class="none">
                          <a href="source-repository.html" title="Source Repository">Source Repository</a>
            </li>
                      <li class="none">
                          <a href="project-summary.html" title="Project Summary">Project Summary</a>
            </li>
              </ul>
        </li>
                                                                                                        <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <h1>LMCiP - Log Called Methods in Production</h1>
<p>Do you want to find out if you have dead code in your project? Than this tool will help you.</p>
<p>It will tell you which classes and methods were never called. But it will only tell you the method name. So it&#x2019;s not possible to differ between overloaded methods. For me it&#x2019;s not an issue and this way the code is very simple. I hope that it isn&#x2019;t an issue for you, too.</p>
<p><b>Note</b>: if some method were never called within the monitoring phase doesn&#x2019;t mean that this methods aren&#x2019;t needed. Only while the monitoring phase nobody needed that methods. To decide how long the monitoring phase should be you can look into the output file - the date time is logged. Use all the information <b>wisely</b>.</p>
<div class="section">
<h2><a name="How_it_works"></a>How it works</h2>
<p>To track the method calls the <tt>lcmip-javaagent</tt> is used. A <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html">Java Agent</a> can instrument the code. This means that the Java Agent will modify the original code to instrument it. In this case a static method call is added at the beginning of each method. The <tt>at.rseiler.lcmip.javaagent.MethodLogger#log()</tt> will be called with the full method name (classname#methodname). The <tt>MethodLogger</tt> stores all method names in an concurrent hash set and writes all new method names to the specified output file. Now you know the used methods.</p>
<p>But how to know the unused methods? You can find that out by using the other two lcmip tools.</p>

<ul>
  
<li><tt>lcmip-jar-analyser</tt>: scans the specified jars and lists all methods</li>
  
<li><tt>lcmip-summary</tt>: takes the file with &#x201c;all methods&#x201d; and the file with the &#x201c;used methods&#x201d; and generates the summary. Listing all unused classes and unused methods.</li>
</ul>
<p>The output of the summary report looks like this:</p>

<div class="source">
<div class="source">
<pre>unused classes: 1/4
unused methods: 5/12

unused classes
at.rseiler.lcmip.demo.UnusedClass

unused methods
at.rseiler.lcmip.demo.Main#&lt;init&gt;
at.rseiler.lcmip.demo.Main$MainInnerClass#unusedMethod
at.rseiler.lcmip.demo.UnusedClass#&lt;init&gt;
at.rseiler.lcmip.demo.UnusedClass#unused
at.rseiler.lcmip.demo.UsedClass#unused
</pre></div></div></div>
<div class="section">
<h2><a name="Usage"></a>Usage</h2>

<ul>
  
<li>start the Java program with <tt>lcmip-javaagent</tt> to get the list of all &#x201c;used methods&#x201d;</li>
  
<li>generate the list of &#x201c;all methods&#x201d; with <tt>lcmip-jar-analyser</tt></li>
  
<li>generate the summary report with <tt>lcmip-summary</tt></li>
</ul>
<p>How to find all unused classes and unused methods of the demo module:</p>

<div class="source">
<div class="source">
<pre>&gt; mvn clean package
lcmip-demo\target&gt; java -javaagent:..\..\lcmip-javaagent\target\lcmip-javaagent-1.0.jar=method-used.txt#at.rseiler.lcmip.demo -jar lcmip-demo-1.0.jar method-used.txt#at.rseiler.lcmip.demo
lcmip-demo\target&gt; java -jar ..\..\lcmip-jar-analyser\target\lcmip-jar-analyser-1.0-jar-with-dependencies.jar lcmip-demo-1.0.jar &gt; method-all.txt
lcmip-demo\target&gt; java -jar ..\..\lcmip-summary\target\lcmip-summary-1.0.jar method-all.txt method-used.txt
</pre></div></div></div>
<div class="section">
<h2><a name="Overhead"></a>Overhead</h2>
<p>For a typical Java application the overhead should not be noticeable. Nevertheless test it before you run it in production.</p></div>
<div class="section">
<h2><a name="What_is_init_and_clinit"></a>What is <tt>&lt;init&gt;</tt> and <tt>&lt;clinit&gt;</tt>?</h2>

<ul>
  
<li><tt>&lt;init&gt;</tt>: it&#x2019;s the initialization block to create an instance (the class member fields).</li>
  
<li><tt>&lt;clinit&gt;</tt>: it&#x2019;s the static initialization block to setup the class (the static class variables).</li>
</ul>
<p><a class="externalLink" href="http://docs.oracle.com/javase/specs/jvms/se6/html/Overview.doc.html#12174">3.9 Specially Named Initialization Methods</a></p>

<blockquote>
<p>At the level of the Java virtual machine, every constructor (&#xa7;2.12) appears as an instance initialization method that has the special name <tt>&lt;init&gt;</tt>. This name is supplied by a compiler. Because the name <tt>&lt;init&gt;</tt> is not a valid identifier, it cannot be used directly in a program written in the Java programming language. Instance initialization methods may be invoked only within the Java virtual machine by the invokespecial instruction, and they may be invoked only on uninitialized class instances. An instance initialization method takes on the access permissions (&#xa7;2.7.4) of the constructor from which it was derived.</p>
<p>A class or interface has at most one class or interface initialization method and is initialized (&#xa7;2.17.4) by invoking that method. The initialization method of a class or interface is static and takes no arguments. It has the special name <tt>&lt;clinit&gt;</tt>. This name is supplied by a compiler. Because the name <tt>&lt;clinit&gt;</tt> is not a valid identifier, it cannot be used directly in a program written in the Java programming language. Class and interface initialization methods are invoked implicitly by the Java virtual machine; they are never invoked directly from any Java virtual machine instruction, but are invoked only indirectly as part of the class initialization process.</p>
</blockquote>
<div class="section">
<h3><a name="Example"></a>Example</h3>

<div class="source">
<div class="source">
<pre>class AClass {

    private static Log LOG = LogFactory.getLog(); // &lt;clinit&gt;

    private int x = 1;   // &lt;init&gt;

    static {
        // &lt;clinit&gt;
    }

    {
        // &lt;init&gt;
    }

    AClass() {
        // &lt;init&gt;
    }

}
</pre></div></div></div></div>
<div class="section">
<h2><a name="Downloads"></a>Downloads</h2>
<p>See <a href="downloads.html">Downloads</a></p></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2015.
          All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>